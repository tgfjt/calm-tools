---
import Layout from '../layouts/Layout.astro';
import { css } from '../../styled-system/css';
import { token } from '../../styled-system/tokens';
import { detectLocaleFromHeader, getTranslations } from '../i18n';

// Detect locale from Accept-Language header (SSR)
const acceptLanguage = Astro.request.headers.get('accept-language');
const locale = detectLocaleFromHeader(acceptLanguage);
const i18n = getTranslations(locale);

const styles = {
  container: css({
    textAlign: 'center',
    padding: token('spacing.8'),
    maxWidth: token('sizes.container'),
    width: '100%',
  }),
  title: css({
    fontSize: token('fontSizes.display'),
    fontWeight: token('fontWeights.light'),
    letterSpacing: token('letterSpacings.heading'),
    marginBottom: '0.5rem',
    textShadow: '2px 2px 4px rgba(0, 0, 0, 0.1)',
  }),
  tagline: css({
    fontSize: token('fontSizes.body-lg'),
    opacity: 0.8,
    marginBottom: token('spacing.12'),
    letterSpacing: token('letterSpacings.button'),
  }),
  cardGrid: css({
    display: 'flex',
    flexDirection: 'column',
    gap: token('spacing.6'),
    sm: {
      flexDirection: 'row',
    },
  }),
  card: css({
    display: 'block',
    padding: token('spacing.8'),
    borderRadius: token('radii.xl'),
    textDecoration: 'none',
    transition: 'all 0.3s ease',
    backdropFilter: 'blur(10px)',
    sm: {
      flex: 1,
    },
    _hover: {
      transform: 'translateY(-4px)',
    },
  }),
  cardBreath: css({
    background: token('colors.breath.surfaceMedium'),
    border: `2px solid ${token('colors.breath.borderMedium')}`,
    color: token('colors.breath.text'),
    _hover: {
      background: token('colors.breath.surfaceStronger'),
      boxShadow: `0 8px 32px ${token('colors.breath.glow')}`,
    },
  }),
  cardGrounding: css({
    background: token('colors.grounding.surfaceWhite'),
    border: `2px solid ${token('colors.grounding.borderWhite')}`,
    color: 'white',
    _hover: {
      background: token('colors.grounding.surfaceWhiteMedium'),
      boxShadow: `0 8px 32px ${token('colors.grounding.surfaceWhite')}`,
    },
  }),
  cardIcon: css({
    fontSize: '3rem',
    marginBottom: token('spacing.4'),
  }),
  cardTitle: css({
    fontSize: token('fontSizes.heading-2'),
    fontWeight: token('fontWeights.regular'),
    letterSpacing: token('letterSpacings.card'),
    marginBottom: '0.5rem',
  }),
  cardDesc: css({
    fontSize: token('fontSizes.body'),
    opacity: 0.8,
    marginBottom: '0.5rem',
  }),
  cardPatterns: css({
    fontSize: token('fontSizes.caption'),
    opacity: 0.6,
    letterSpacing: token('letterSpacings.caption'),
  }),
};
---

<Layout title="calm" theme="home">
  <div class={styles.container}>
    <h1 class={styles.title}>calm</h1>
    <p class={styles.tagline}>{i18n.index.tagline}</p>

    <div class={styles.cardGrid}>
      <a href="/breath" class={`${styles.card} ${styles.cardBreath}`}>
        <div class={styles.cardIcon}>üåø</div>
        <h2 class={styles.cardTitle}>{i18n.index.breathTitle}</h2>
        <p class={styles.cardDesc}>{i18n.index.breathDesc}</p>
        <span class={styles.cardPatterns}>{i18n.index.breathPatterns}</span>
      </a>

      <a href="/grounding" class={`${styles.card} ${styles.cardGrounding}`}>
        <div class={styles.cardIcon}>üêë</div>
        <h2 class={styles.cardTitle}>{i18n.index.groundingTitle}</h2>
        <p class={styles.cardDesc}>{i18n.index.groundingDesc}</p>
        <span class={styles.cardPatterns}>{i18n.index.groundingPatterns}</span>
      </a>
    </div>
  </div>
</Layout>
