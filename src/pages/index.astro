---
import Layout from '../layouts/Layout.astro';
import { css } from '../../styled-system/css';
import { token } from '../../styled-system/tokens';
import { detectLocaleFromHeader, getTranslations } from '../i18n';

// Detect locale from Accept-Language header (SSR)
const acceptLanguage = Astro.request.headers.get('accept-language');
const locale = detectLocaleFromHeader(acceptLanguage);
const i18n = getTranslations(locale);

const styles = {
  container: css({
    textAlign: 'center',
    padding: '2rem',
    maxWidth: '600px',
    width: '100%',
  }),
  title: css({
    fontSize: '2.5rem',
    fontWeight: 200,
    letterSpacing: '0.2em',
    marginBottom: '0.5rem',
  }),
  tagline: css({
    fontSize: '1.1rem',
    fontWeight: 300,
    opacity: 0.8,
    marginBottom: '3rem',
    letterSpacing: '0.1em',
  }),
  cardGrid: css({
    display: 'flex',
    flexDirection: 'column',
    gap: '1.5rem',
    sm: {
      flexDirection: 'row',
    },
  }),
  card: css({
    display: 'block',
    padding: '2rem',
    borderRadius: '24px',
    textDecoration: 'none',
    transition: 'all 0.3s ease',
    sm: {
      flex: 1,
    },
    _hover: {
      transform: 'translateY(-4px)',
    },
  }),
  cardBreath: css({
    background: 'transparent',
    border: '1px solid rgba(226,226,240,0.2)',
    color: token('colors.breath.text'),
    _hover: {
      background: 'transparent',
      borderColor: 'rgba(226,226,240,0.5)',
    },
  }),
  cardGrounding: css({
    background: 'transparent',
    border: '1px solid rgba(226,226,240,0.2)',
    color: 'white',
    _hover: {
      background: 'transparent',
      borderColor: 'rgba(226,226,240,0.5)',
    },
  }),
  cardIcon: css({
    fontSize: '3rem',
    marginBottom: '1rem',
  }),
  cardTitle: css({
    fontSize: '1.5rem',
    fontWeight: 300,
    letterSpacing: '0.15em',
    marginBottom: '0.5rem',
  }),
  cardDesc: css({
    fontSize: '1rem',
    fontWeight: 300,
    opacity: 0.8,
    marginBottom: '0.5rem',
  }),
  cardPatterns: css({
    fontSize: '0.85rem',
    opacity: 0.6,
    letterSpacing: '0.05em',
  }),
};
---

<Layout title="calm" theme="home">
  <div class={styles.container}>
    <h1 class={styles.title}>calm</h1>
    <p class={styles.tagline}>{i18n.index.tagline}</p>

    <div class={styles.cardGrid}>
      <a href="/breath" class={`${styles.card} ${styles.cardBreath}`}>
        <div class={styles.cardIcon}>üåø</div>
        <h2 class={styles.cardTitle}>{i18n.index.breathTitle}</h2>
        <p class={styles.cardDesc}>{i18n.index.breathDesc}</p>
        <span class={styles.cardPatterns}>{i18n.index.breathPatterns}</span>
      </a>

      <a href="/grounding" class={`${styles.card} ${styles.cardGrounding}`}>
        <div class={styles.cardIcon}>üêë</div>
        <h2 class={styles.cardTitle}>{i18n.index.groundingTitle}</h2>
        <p class={styles.cardDesc}>{i18n.index.groundingDesc}</p>
        <span class={styles.cardPatterns}>{i18n.index.groundingPatterns}</span>
      </a>
    </div>
  </div>
</Layout>
